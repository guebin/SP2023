{"title":"15wk-1: MCMC (3)","markdown":{"yaml":{"title":"15wk-1: MCMC (3)","author":"최규빈","date":"06/01/2023","bibliography":"ref.bib","title-block-style":"none","title-block-banner":false},"headingText":"강의영상","containsRefs":false,"markdown":"\n\n\n> youtube: <https://youtube.com/playlist?list=PLQqh36zP38-z-M7HO1xUnq2z5lK8aq1_a>\n\n# imports\n\n# 모티브\n\n`-` 축구기사 \n\n- 손흥민: <https://www.hani.co.kr/arti/sports/soccer/1093315.html>\n\n`-` 16강진출 경우의 수 \n\n- 16강 가능할까? : <https://www.fifa.com/fifaplus/ko/articles/number-of-cases-korea-goes-to-round-of-16>\n\n`-` 통계, 데이터과학 \n\n- 생략 \n\n# 문제소개\n\n`-` 3개의 문서가 있으며 각 문서에는 아래와 같이 2개의 단어가 있는 데이터를 고려하자. \n\n- 여기에서 $D$는 문서들의 집합, 즉 코퍼스를 의미한다. \n\n`-` 데이터설명 \n\n***토픽***\n\n- 토픽0 = 축구 : '골', '손흥민' 와 같은 단어가 쓰임. \n- 토픽1 = 통계 : '데이터과학', '확률' 와 같은 단어가 쓰임. \n\n***문서***\n    \n- doc0은 축구를 주제로 쓰여진 글인듯 하다.\n- doc2은 데이터과학을 주제로 쓰여진 글인듯 하다. \n- doc1는 축구와 데이터과학이 혼합된 주제인듯 하다. \n\n`-` 원하는 것1: 문서별로 토픽이 얼마나 들어있는지 알고싶다. \n\n- 즉 $D$를 입력으로 넣으면 아래와 같은 $\\theta$ 가 나오면 좋겠음 \n\n::: {#tbl-panel layout-ncol=2}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 1 | 2 |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}$: 추정된 토픽 {#tbl-second}\n\n우리가 원하는것 (1)\n:::\n\n`-` 원하는것1에 대한 아쉬움\n\n- 그런데 생각해보니까 \"손흥민\"이라는 단어는 완전 축구단어\n- \"골\"이라는 단어는 가끔 데이터과학과 섞일 수 있는 단어 \n- \"손흥민\"이라는 단어는 축구토픽에서 나올 확률이 90퍼 이상, \"골\"은 축구토픽에서 나올 확률이 80퍼정도일수도 있잖음? \n\n`-` 원하는 것2: 특정한 하나의 ${\\boldsymbol \\theta}$ 값이 아니라 아래와 같이\n\n$${\\boldsymbol \\theta} \\sim {\\boldsymbol \\pi}$$\n\n${\\boldsymbol \\theta}$를 뽑아낼 수 있는 분포 ${\\boldsymbol \\pi}$를 알아내는게 더 좋지 않을까? \n\n::: {#tbl-panel layout-ncol=3}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 1 | 2 |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}$: 토픽 {#tbl-second}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| $\\begin{bmatrix}0.9\\\\0.1\\end{bmatrix}$ | $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$  |\n| $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$ | $\\begin{bmatrix}0.05\\\\0.95\\end{bmatrix}$  |\n\n: ${\\boldsymbol \\pi}$: 정상분포 {#tbl-second}\n\n\n우리가 원하는것 (2)\n:::\n\n`-` 어려운점: 현재 ${\\boldsymbol \\pi}$ (=${\\boldsymbol \\theta}$의 pmf) 의 수식을 알 수 없어서 직접 뽑기 어렵다. \n\n# 가능한 해결책: 아이디어 단계\n\n`-` 이론적인 근거는 아직 설명하기 어렵지만 되게 그럴듯한 해결책이 있습니다. \n\n`-` 문제의 단순화:\n    \n- 결국 길이가 6인 랜덤벡터 ${\\boldsymbol \\theta}=(\\theta[0],\\dots,\\theta[5])$ 를 뽑는 일이다. \n\n## ***단계1: 아무값이나 넣어서 ${\\boldsymbol \\theta}_0$를 초기화한다.***\n\n`-` ${\\boldsymbol \\theta}_0=(\\theta_0[0],\\dots,\\theta_0[5])$를 아무값이나 셋팅 \n\n- ${\\boldsymbol \\theta}_0 = [2,1,1,2,2,1]$ 이라고 생각하자. \n\n`-` 임의의 초기값이 셋팅된 상황은 아래와 같다. \n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 2 (=$\\theta_0[0]$) | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| 1 (=$\\theta_0[1]$) | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 임의의 초기값으로 설정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | 골, 골, 데이터과학 |\n| 2 | 손흥민, 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n초기상태요약\n:::\n\n\n\n## ***단계2: ${\\boldsymbol \\theta}_0[0], {\\boldsymbol \\theta}_0[1] \\cdots, {\\boldsymbol \\theta}_0[5]$ 을 순서대로 샘플링***\n\n***`-` 예비개념: MCMC에서 베타분포를 뽑았던 예제로 돌아가보자*** \n\n1. 임의의 초기값 $x$ 생성 \n2. 새로운 값으로 $y$를 고려 (추천받을 수도 있고 그냥 고려할수도 있음)\n3. $x$가 그럴듯한지, $y$가 그럴듯한지 판단하고 $x'$의 값은 어떠한확률로 $x,y$ 중에서 선택\n\n`-` 전략: 그동안 pmf 혹은 pdf의 정보가 필요했던 것은 \"그럴듯한 정도\" 를 판단할 기준을 얻기 위해서였다. 그런데 만약, \"그럴듯한 정도\"를 판단하는 기준을 pmf, pdf 로 정하지 않는다면? pmf 혹은 pdf 가 필요하지 않다. \n\n### stage0: ***${\\boldsymbol \\theta}_0[0]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: red; font-weight: bold;\">손흥민</span> | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: red; font-weight: bold;\"> 2 (=$\\theta_0[0]$)</span> | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| 1 (=$\\theta_0[1]$) | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | 골, 골, 데이터과학 |\n| 2 | <span style=\"color: red; font-weight: bold;\">손흥민</span>, 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1으로 분류되어있음|나도 토픽1인듯|\n|토픽눈치|토픽1에도, 토픽2에도 나랑 같은 단어는 없음|난 토픽1도 2도 아닌듯|\n: $\\theta_0[0]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc1}$, $w={\\tt 손흥민}$\n:::\n\n\n\n`-` $\\theta_0[0]$이 토픽1에서 뽑혓다고 보는게 타당한지 토픽1에서 뽑혔다고 보는게 타당하지 아래와 같이 따져보자.\n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `손흥민`이라는 단어가 포함된 비율) = 1 $\\times$ 0\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `손흥민`이라는 단어가 포함된 비율) = 0 $\\times$ 0\n\n> 둘 다 $0$ 이라서 비긴거야?? 그런데 그래도 토픽1가 그나마 타당한거아냐? \n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `손흥민`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `손흥민`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n\n> $\\theta_0[0]$의 생각: 나는 토픽1인듯해\n\n`-` 업데이트 \n\n### stage1: ***${\\boldsymbol \\theta}_0[1]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | 골    | 확률    |\n| <span style=\"color: red; font-weight: bold;\">골</span>    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: red; font-weight: bold;\"> 1 (=$\\theta_0[1]$)</span> | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: red; font-weight: bold;\">골</span>, 골, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1으로 분류되어있음 |나도 토픽1인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 있는데 토픽2에는 없음 |나도 토픽1인듯|\n: $\\theta_0[1]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc1}$, $w={\\tt 골}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `골`이라는 단어가 포함된 비율) = 1 $\\times$ 1/3\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `골`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n\n> $\\theta_0[1]$의 생각: 나는 토픽1인듯해\n\n`-` 업데이트: 안함.. 난 토픽1이 맞는것 같음\n\n### stage2: ***${\\boldsymbol \\theta}_0[2]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: red; font-weight: bold;\">골</span> | 확률    |\n| <span style=\"color: blue; \">골</span>    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: red; font-weight: bold;\"> 1 (=$\\theta_0[2]$) </span> | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, <span style=\"color: red; font-weight: bold;\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 있는데 토픽2에는 없음 |나도 토픽1인듯|\n: $\\theta_0[2]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc2}$, $w={\\tt 골}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc2`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `골`이라는 단어가 포함된 비율) = 0.001 $\\times$ 1/3\n- 토픽2의 타당성: (`doc2`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `골`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n\n> $\\theta_0[2]$의 생각: 나는 토픽2인듯함 (그런데 아닐 수도 있음)\n\n`-` 업데이트\n\n### stage3: ***${\\boldsymbol \\theta}_0[3]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | 확률    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: red; font-weight: bold;\">확률</span>    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: red; font-weight: bold;\"> 2 (=$\\theta_0[3]$)</span> | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: red; font-weight: bold;\">확률</span>, 확률, <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 없는데 토픽2에는 있음 |나도 토픽2인듯|\n: $\\theta_0[3]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc2}$, $w={\\tt 확률}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc2`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `확률`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n- 토픽2의 타당성: (`doc2`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `확률`이라는 단어가 포함된 비율) = 1 $\\times$ 1/2\n\n> $\\theta_0[3]$의 생각: 나는 토픽2인듯함\n\n`-` 업데이트: 안함. 난 토픽2가 확실한듯 \n\n### stage4: ***${\\boldsymbol \\theta}_0[4]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | <span style=\"color: red; font-weight: bold;\">확률</span>    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: blue\">확률</span>    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | <span style=\"color: red; font-weight: bold;\">2 (=$\\theta_0[4]$)</span> |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: blue\"> 2 (=$\\theta_1[3]$)</span> | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: blue\">확률</span>, <span style=\"color: red; font-weight: bold;\">확률</span>, <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1로 분류되어있음 |나도 토픽1인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 없는데 토픽2에는 있음 |나도 토픽2인듯|\n: $\\theta_0[4]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc3}$, $w={\\tt 확률}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc3`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `확률`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n- 토픽2의 타당성: (`doc3`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `확률`이라는 단어가 포함된 비율) = 0.001 $\\times$ 1/2\n\n> $\\theta_0[4]$의 생각: 나는 토픽1인듯함 (그런데 아닐수도 있음)\n\n`-` 업데이트: 안함. 난 토픽1인것 같긴한데, 확실하지 않아서 그냥 토픽2에 머무르겠음. \n\n### stage5: ***${\\boldsymbol \\theta}_0[5]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | <span style=\"color: blue\">확률</span>    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: blue\">확률</span>    | <span style=\"color: red; font-weight: bold;\">데이터과학</span>  |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | <span style=\"color: blue\">2 (=$\\theta_1[4]$)</span>^[업데이트 할수도 있었는데 안했음] |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: blue\"> 2 (=$\\theta_1[3]$)</span> | <span style=\"color: red; font-weight: bold;\">1 (=$\\theta_0[5]$)</span>  |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, <span style=\"color: red; font-weight: bold;\">데이터과학<span>, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: blue\">확률</span>, <span style=\"color: blue\">확률</span>^[1로 바뀔수도 있었는데 안바꾸었음], <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에도, 토픽2에도 나랑 같은 단어는 없음 |나는 토픽1도 토픽2도 아닌듯|\n: $\\theta_0[5]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc3}$, $w={\\tt 데이터과학}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc3`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `데이터과학`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n- 토픽2의 타당성: (`doc3`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `데이터과학`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n\n> $\\theta_0[5]$의 생각: 나는 토픽1인듯함 (그런데 아닐수도 있음)\n\n`-` 업데이트: 난 토픽2가 확실한듯 \n\n## 단계3: $t=1,2,3,4,\\dots$ 에 대하여 단계2를 반복\n\n`-` 초기상태와 지금을 비교하면 아래와 같다. \n\n::: {#tbl-panel layout-ncol=3}\n\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| $\\begin{bmatrix}0.9\\\\0.1\\end{bmatrix}$ | $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$  |\n| $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$ | $\\begin{bmatrix}0.05\\\\0.95\\end{bmatrix}$  |\n\n\n: ${\\boldsymbol \\pi}$\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 2 | 1 | 2 |\n| 1 | 2 | 1 |\n\n: ${\\boldsymbol \\theta}_0$\n\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 2^[1일수도 있었음] | 2^[1일 수도 있었음] |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}_1$\n\n수정된 상태\n:::\n\n\n\n`-` $t=1,2,3,4\\dots$로 진행하다보면 서로 눈치를 보면서 아래와 같은 원리로 이동한다. \n\n1. 문서눈치: 내가 토픽k 라면, 내가 속한 문서에는 토픽k로 분류된 단어가 많을거야. \n2. 토픽눈치: 내가 토픽k 라면, 토픽k에는 나랑 같은 단어가 많을거야. \n\n# 구현 \n\n## 구현에 필요한 예비학습\n\n### ***enumerate***\n\n### ***np.random.choice***\n\n### ***딕셔너리의 해체***\n\n`-` 아래와 같은 딕셔너리를 고려하자. \n\n`-` 이러한 딕셔너리에를 해체하고 싶다면? \n\n### ***리스트의 count 메소드***\n\n### ***조건부 컴프리헨션***\n\n### ***딕셔너리의 원소삭제***\n\n### ***깊은복사***\n\n`-` 특정원소가 삭제된 dct와 삭제되지 않은 dct를 동시에 가지고 있으려면?\n\n`-` 해결책 \n\n### ***연습문제***\n\n아래와 같은 자료가 있다고 하자. \n\n`(1)` $D$에는 총 몇개의 단어가 있는가? \n\n`(2)` 문서2에 토픽1은 몇개나 있는가? \n\n`(3)` 토픽1에 들어있는 단어들의 목록을 구하라. \n\n`(4)` 토픽1에서 '골'이라는 단어는 몇번 등장하는가? \n\n## 데이터: $D$와 $\\theta$의 설정 \n\n`-` 간단한 데이터 조사\n\n- 데이터는 총 15개의 문서로 이루어져 있으며 처음5개의 문서는 축구관련, 이후 5개는 축구와 통계 관련, 이후 5개는 통계관련이다. \n- 축구와 통계가 섞인 `doc6~doc11`은 축구관련4단어, 통계관련7단어, 축구관련4단어의 조합으로 이루어져 있다. \n\n`-` 초기값 \n\n`-` D와 $\\theta$를 묶어서 하나의 dict를 만들자.\n\n## 하이퍼파라메터\n\n## 필요한 함수 \n\n`-` $p_1$: $d$-th document에 포함된 토픽 $k$의 비율을 리턴하는 함수, 즉 아래를 계산한다. \n\n$$p_1=:\\frac{\\#({\\tt topic == k, document == d})+0.1}{\\#({\\tt document == d})+0.1\\times K}$$\n\n여기에서 $K$는 토픽의 수.\n\n`-` $p_2$: $k$-th topic에 포함된 단어 $w$의 비율을 리턴하는 함수, 즉 아래를 계산한다. \n\n$$p_2=:\\frac{\\#({\\tt word ==w, topic == k})+0.1}{\\#({\\tt topic == k})+0.1\\times W}$$\n\n여기에서 $W$는 전체단어의 수. (이 예제의 경우 40개의 단어로 이루어짐)\n\n## 알고리즘 \n\n### ***1. 초기값: ${\\boldsymbol \\theta}_0$***\n\n### ***2. 반복: ${\\boldsymbol \\theta}_0 \\to {\\boldsymbol \\theta}_1 \\to {\\boldsymbol \\theta}_2 \\to \\dots$***\n\n## 시각화 \n","srcMarkdownNoYaml":"\n\n# 강의영상 \n\n> youtube: <https://youtube.com/playlist?list=PLQqh36zP38-z-M7HO1xUnq2z5lK8aq1_a>\n\n# imports\n\n# 모티브\n\n`-` 축구기사 \n\n- 손흥민: <https://www.hani.co.kr/arti/sports/soccer/1093315.html>\n\n`-` 16강진출 경우의 수 \n\n- 16강 가능할까? : <https://www.fifa.com/fifaplus/ko/articles/number-of-cases-korea-goes-to-round-of-16>\n\n`-` 통계, 데이터과학 \n\n- 생략 \n\n# 문제소개\n\n`-` 3개의 문서가 있으며 각 문서에는 아래와 같이 2개의 단어가 있는 데이터를 고려하자. \n\n- 여기에서 $D$는 문서들의 집합, 즉 코퍼스를 의미한다. \n\n`-` 데이터설명 \n\n***토픽***\n\n- 토픽0 = 축구 : '골', '손흥민' 와 같은 단어가 쓰임. \n- 토픽1 = 통계 : '데이터과학', '확률' 와 같은 단어가 쓰임. \n\n***문서***\n    \n- doc0은 축구를 주제로 쓰여진 글인듯 하다.\n- doc2은 데이터과학을 주제로 쓰여진 글인듯 하다. \n- doc1는 축구와 데이터과학이 혼합된 주제인듯 하다. \n\n`-` 원하는 것1: 문서별로 토픽이 얼마나 들어있는지 알고싶다. \n\n- 즉 $D$를 입력으로 넣으면 아래와 같은 $\\theta$ 가 나오면 좋겠음 \n\n::: {#tbl-panel layout-ncol=2}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 1 | 2 |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}$: 추정된 토픽 {#tbl-second}\n\n우리가 원하는것 (1)\n:::\n\n`-` 원하는것1에 대한 아쉬움\n\n- 그런데 생각해보니까 \"손흥민\"이라는 단어는 완전 축구단어\n- \"골\"이라는 단어는 가끔 데이터과학과 섞일 수 있는 단어 \n- \"손흥민\"이라는 단어는 축구토픽에서 나올 확률이 90퍼 이상, \"골\"은 축구토픽에서 나올 확률이 80퍼정도일수도 있잖음? \n\n`-` 원하는 것2: 특정한 하나의 ${\\boldsymbol \\theta}$ 값이 아니라 아래와 같이\n\n$${\\boldsymbol \\theta} \\sim {\\boldsymbol \\pi}$$\n\n${\\boldsymbol \\theta}$를 뽑아낼 수 있는 분포 ${\\boldsymbol \\pi}$를 알아내는게 더 좋지 않을까? \n\n::: {#tbl-panel layout-ncol=3}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 1 | 2 |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}$: 토픽 {#tbl-second}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| $\\begin{bmatrix}0.9\\\\0.1\\end{bmatrix}$ | $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$  |\n| $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$ | $\\begin{bmatrix}0.05\\\\0.95\\end{bmatrix}$  |\n\n: ${\\boldsymbol \\pi}$: 정상분포 {#tbl-second}\n\n\n우리가 원하는것 (2)\n:::\n\n`-` 어려운점: 현재 ${\\boldsymbol \\pi}$ (=${\\boldsymbol \\theta}$의 pmf) 의 수식을 알 수 없어서 직접 뽑기 어렵다. \n\n# 가능한 해결책: 아이디어 단계\n\n`-` 이론적인 근거는 아직 설명하기 어렵지만 되게 그럴듯한 해결책이 있습니다. \n\n`-` 문제의 단순화:\n    \n- 결국 길이가 6인 랜덤벡터 ${\\boldsymbol \\theta}=(\\theta[0],\\dots,\\theta[5])$ 를 뽑는 일이다. \n\n## ***단계1: 아무값이나 넣어서 ${\\boldsymbol \\theta}_0$를 초기화한다.***\n\n`-` ${\\boldsymbol \\theta}_0=(\\theta_0[0],\\dots,\\theta_0[5])$를 아무값이나 셋팅 \n\n- ${\\boldsymbol \\theta}_0 = [2,1,1,2,2,1]$ 이라고 생각하자. \n\n`-` 임의의 초기값이 셋팅된 상황은 아래와 같다. \n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 손흥민 | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 2 (=$\\theta_0[0]$) | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| 1 (=$\\theta_0[1]$) | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 임의의 초기값으로 설정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | 골, 골, 데이터과학 |\n| 2 | 손흥민, 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n초기상태요약\n:::\n\n\n\n## ***단계2: ${\\boldsymbol \\theta}_0[0], {\\boldsymbol \\theta}_0[1] \\cdots, {\\boldsymbol \\theta}_0[5]$ 을 순서대로 샘플링***\n\n***`-` 예비개념: MCMC에서 베타분포를 뽑았던 예제로 돌아가보자*** \n\n1. 임의의 초기값 $x$ 생성 \n2. 새로운 값으로 $y$를 고려 (추천받을 수도 있고 그냥 고려할수도 있음)\n3. $x$가 그럴듯한지, $y$가 그럴듯한지 판단하고 $x'$의 값은 어떠한확률로 $x,y$ 중에서 선택\n\n`-` 전략: 그동안 pmf 혹은 pdf의 정보가 필요했던 것은 \"그럴듯한 정도\" 를 판단할 기준을 얻기 위해서였다. 그런데 만약, \"그럴듯한 정도\"를 판단하는 기준을 pmf, pdf 로 정하지 않는다면? pmf 혹은 pdf 가 필요하지 않다. \n\n### stage0: ***${\\boldsymbol \\theta}_0[0]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: red; font-weight: bold;\">손흥민</span> | 골    | 확률    |\n| 골    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: red; font-weight: bold;\"> 2 (=$\\theta_0[0]$)</span> | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| 1 (=$\\theta_0[1]$) | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | 골, 골, 데이터과학 |\n| 2 | <span style=\"color: red; font-weight: bold;\">손흥민</span>, 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1으로 분류되어있음|나도 토픽1인듯|\n|토픽눈치|토픽1에도, 토픽2에도 나랑 같은 단어는 없음|난 토픽1도 2도 아닌듯|\n: $\\theta_0[0]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc1}$, $w={\\tt 손흥민}$\n:::\n\n\n\n`-` $\\theta_0[0]$이 토픽1에서 뽑혓다고 보는게 타당한지 토픽1에서 뽑혔다고 보는게 타당하지 아래와 같이 따져보자.\n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `손흥민`이라는 단어가 포함된 비율) = 1 $\\times$ 0\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `손흥민`이라는 단어가 포함된 비율) = 0 $\\times$ 0\n\n> 둘 다 $0$ 이라서 비긴거야?? 그런데 그래도 토픽1가 그나마 타당한거아냐? \n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `손흥민`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `손흥민`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n\n> $\\theta_0[0]$의 생각: 나는 토픽1인듯해\n\n`-` 업데이트 \n\n### stage1: ***${\\boldsymbol \\theta}_0[1]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | 골    | 확률    |\n| <span style=\"color: red; font-weight: bold;\">골</span>    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | 1 (=$\\theta_0[2]$) | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: red; font-weight: bold;\"> 1 (=$\\theta_0[1]$)</span> | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: red; font-weight: bold;\">골</span>, 골, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1으로 분류되어있음 |나도 토픽1인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 있는데 토픽2에는 없음 |나도 토픽1인듯|\n: $\\theta_0[1]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc1}$, $w={\\tt 골}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc1`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `골`이라는 단어가 포함된 비율) = 1 $\\times$ 1/3\n- 토픽2의 타당성: (`doc1`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `골`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n\n> $\\theta_0[1]$의 생각: 나는 토픽1인듯해\n\n`-` 업데이트: 안함.. 난 토픽1이 맞는것 같음\n\n### stage2: ***${\\boldsymbol \\theta}_0[2]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: red; font-weight: bold;\">골</span> | 확률    |\n| <span style=\"color: blue; \">골</span>    | 확률    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: red; font-weight: bold;\"> 1 (=$\\theta_0[2]$) </span> | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | 2 (=$\\theta_0[3]$) | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, <span style=\"color: red; font-weight: bold;\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | 확률, 확률 |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 있는데 토픽2에는 없음 |나도 토픽1인듯|\n: $\\theta_0[2]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc2}$, $w={\\tt 골}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc2`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `골`이라는 단어가 포함된 비율) = 0.001 $\\times$ 1/3\n- 토픽2의 타당성: (`doc2`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `골`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n\n> $\\theta_0[2]$의 생각: 나는 토픽2인듯함 (그런데 아닐 수도 있음)\n\n`-` 업데이트\n\n### stage3: ***${\\boldsymbol \\theta}_0[3]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | 확률    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: red; font-weight: bold;\">확률</span>    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | 2 (=$\\theta_0[4]$) |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: red; font-weight: bold;\"> 2 (=$\\theta_0[3]$)</span> | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: red; font-weight: bold;\">확률</span>, 확률, <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 없는데 토픽2에는 있음 |나도 토픽2인듯|\n: $\\theta_0[3]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc2}$, $w={\\tt 확률}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc2`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `확률`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n- 토픽2의 타당성: (`doc2`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `확률`이라는 단어가 포함된 비율) = 1 $\\times$ 1/2\n\n> $\\theta_0[3]$의 생각: 나는 토픽2인듯함\n\n`-` 업데이트: 안함. 난 토픽2가 확실한듯 \n\n### stage4: ***${\\boldsymbol \\theta}_0[4]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | <span style=\"color: red; font-weight: bold;\">확률</span>    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: blue\">확률</span>    | 데이터과학    |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | <span style=\"color: red; font-weight: bold;\">2 (=$\\theta_0[4]$)</span> |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: blue\"> 2 (=$\\theta_1[3]$)</span> | 1 (=$\\theta_0[5]$) |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, 데이터과학, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: blue\">확률</span>, <span style=\"color: red; font-weight: bold;\">확률</span>, <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽1로 분류되어있음 |나도 토픽1인듯|\n|토픽눈치|토픽1에는 나랑 같은 단어가 없는데 토픽2에는 있음 |나도 토픽2인듯|\n: $\\theta_0[4]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc3}$, $w={\\tt 확률}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc3`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `확률`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n- 토픽2의 타당성: (`doc3`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `확률`이라는 단어가 포함된 비율) = 0.001 $\\times$ 1/2\n\n> $\\theta_0[4]$의 생각: 나는 토픽1인듯함 (그런데 아닐수도 있음)\n\n`-` 업데이트: 안함. 난 토픽1인것 같긴한데, 확실하지 않아서 그냥 토픽2에 머무르겠음. \n\n### stage5: ***${\\boldsymbol \\theta}_0[5]$을 sampling***\n\n`-` 현재상태\n\n- 빨간색/볼드: 지금 focus하는 것\n- 파란색/볼드: 과거 / 업데이트O\n- 파란색/볼드X: 과거 / 업데이트X\n\n::: {#tbl-panel layout=[[1,1],[1,1]]}\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\">손흥민</span> | <span style=\"color: blue; font-weight: bold;\">골</span> | <span style=\"color: blue\">확률</span>    |\n| <span style=\"color: blue; \">골</span>    | <span style=\"color: blue\">확률</span>    | <span style=\"color: red; font-weight: bold;\">데이터과학</span>  |\n\n: $D$: 코퍼스(=관찰한자료) {#tbl-first}\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| <span style=\"color: blue; font-weight: bold;\"> 1 (=$\\theta_1[0]$)</span>^[원래 2였는데 업데이트되었음] | <span style=\"color: blue; font-weight: bold;\"> 2 (=$\\theta_1[2]$) </span>^[원래 1이었는데 업데이트되었음, 업데이트 안될수도 있었음.] | <span style=\"color: blue\">2 (=$\\theta_1[4]$)</span>^[업데이트 할수도 있었는데 안했음] |\n| <span style=\"color: blue;\"> 1 (=$\\theta_1[1]$)</span> | <span style=\"color: blue\"> 2 (=$\\theta_1[3]$)</span> | <span style=\"color: red; font-weight: bold;\">1 (=$\\theta_0[5]$)</span>  |\n\n: ${\\boldsymbol \\theta}_t$: 추정된 토픽 {#tbl-second}\n\n| topic| words|\n|------|------|\n| 1 | <span style=\"color: blue\">골</span>, <span style=\"color: red; font-weight: bold;\">데이터과학<span>, <span style=\"color: blue; font-weight: bold;\">손흥민</span>^[원래 2에 있었은데 1로 옮겼음] |\n| 2 | <span style=\"color: blue\">확률</span>, <span style=\"color: blue\">확률</span>^[1로 바뀔수도 있었는데 안바꾸었음], <span style=\"color: blue; font-weight: bold;\">골</span>^[원래 1에 있었은데 2로 옮겼음, 안바뀔수도 있었음.] |\n\n: 토픽별로 등장하는 단어 {tbl-colwidths=\"[25,75]\"}\n\n||관찰|결론|\n|---|---|---|\n|문서눈치|문서안에서 나말고 다른 단어는 토픽2로 분류되어있음 |나도 토픽2인듯|\n|토픽눈치|토픽1에도, 토픽2에도 나랑 같은 단어는 없음 |나는 토픽1도 토픽2도 아닌듯|\n: $\\theta_0[5]$의 고민 = 나는 토픽1인가 토픽2인가?\n\n$t=0$, $d={\\tt doc3}$, $w={\\tt 데이터과학}$\n:::\n\n\n\n`-` 수정된 타당성 \n\n- 토픽1의 타당성: (`doc3`에 토픽1이 포함된 비율) $\\times$ (토픽1에서 `데이터과학`이라는 단어가 포함된 비율) = 0.001 $\\times$ 0.001\n- 토픽2의 타당성: (`doc3`에 토픽2가 포함된 비율) $\\times$ (토픽2에서 `데이터과학`이라는 단어가 포함된 비율) = 1 $\\times$ 0.001\n\n> $\\theta_0[5]$의 생각: 나는 토픽1인듯함 (그런데 아닐수도 있음)\n\n`-` 업데이트: 난 토픽2가 확실한듯 \n\n## 단계3: $t=1,2,3,4,\\dots$ 에 대하여 단계2를 반복\n\n`-` 초기상태와 지금을 비교하면 아래와 같다. \n\n::: {#tbl-panel layout-ncol=3}\n\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| $\\begin{bmatrix}0.9\\\\0.1\\end{bmatrix}$ | $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$  |\n| $\\begin{bmatrix}0.8\\\\0.2\\end{bmatrix}$ | $\\begin{bmatrix}0.3\\\\0.7\\end{bmatrix}$ | $\\begin{bmatrix}0.05\\\\0.95\\end{bmatrix}$  |\n\n\n: ${\\boldsymbol \\pi}$\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 2 | 1 | 2 |\n| 1 | 2 | 1 |\n\n: ${\\boldsymbol \\theta}_0$\n\n\n| doc1 | doc2 | doc3 |\n|------|------|------|\n| 1 | 2^[1일수도 있었음] | 2^[1일 수도 있었음] |\n| 1 | 2 | 2 |\n\n: ${\\boldsymbol \\theta}_1$\n\n수정된 상태\n:::\n\n\n\n`-` $t=1,2,3,4\\dots$로 진행하다보면 서로 눈치를 보면서 아래와 같은 원리로 이동한다. \n\n1. 문서눈치: 내가 토픽k 라면, 내가 속한 문서에는 토픽k로 분류된 단어가 많을거야. \n2. 토픽눈치: 내가 토픽k 라면, 토픽k에는 나랑 같은 단어가 많을거야. \n\n# 구현 \n\n## 구현에 필요한 예비학습\n\n### ***enumerate***\n\n### ***np.random.choice***\n\n### ***딕셔너리의 해체***\n\n`-` 아래와 같은 딕셔너리를 고려하자. \n\n`-` 이러한 딕셔너리에를 해체하고 싶다면? \n\n### ***리스트의 count 메소드***\n\n### ***조건부 컴프리헨션***\n\n### ***딕셔너리의 원소삭제***\n\n### ***깊은복사***\n\n`-` 특정원소가 삭제된 dct와 삭제되지 않은 dct를 동시에 가지고 있으려면?\n\n`-` 해결책 \n\n### ***연습문제***\n\n아래와 같은 자료가 있다고 하자. \n\n`(1)` $D$에는 총 몇개의 단어가 있는가? \n\n`(2)` 문서2에 토픽1은 몇개나 있는가? \n\n`(3)` 토픽1에 들어있는 단어들의 목록을 구하라. \n\n`(4)` 토픽1에서 '골'이라는 단어는 몇번 등장하는가? \n\n## 데이터: $D$와 $\\theta$의 설정 \n\n`-` 간단한 데이터 조사\n\n- 데이터는 총 15개의 문서로 이루어져 있으며 처음5개의 문서는 축구관련, 이후 5개는 축구와 통계 관련, 이후 5개는 통계관련이다. \n- 축구와 통계가 섞인 `doc6~doc11`은 축구관련4단어, 통계관련7단어, 축구관련4단어의 조합으로 이루어져 있다. \n\n`-` 초기값 \n\n`-` D와 $\\theta$를 묶어서 하나의 dict를 만들자.\n\n## 하이퍼파라메터\n\n## 필요한 함수 \n\n`-` $p_1$: $d$-th document에 포함된 토픽 $k$의 비율을 리턴하는 함수, 즉 아래를 계산한다. \n\n$$p_1=:\\frac{\\#({\\tt topic == k, document == d})+0.1}{\\#({\\tt document == d})+0.1\\times K}$$\n\n여기에서 $K$는 토픽의 수.\n\n`-` $p_2$: $k$-th topic에 포함된 단어 $w$의 비율을 리턴하는 함수, 즉 아래를 계산한다. \n\n$$p_2=:\\frac{\\#({\\tt word ==w, topic == k})+0.1}{\\#({\\tt topic == k})+0.1\\times W}$$\n\n여기에서 $W$는 전체단어의 수. (이 예제의 경우 40개의 단어로 이루어짐)\n\n## 알고리즘 \n\n### ***1. 초기값: ${\\boldsymbol \\theta}_0$***\n\n### ***2. 반복: ${\\boldsymbol \\theta}_0 \\to {\\boldsymbol \\theta}_1 \\to {\\boldsymbol \\theta}_2 \\to \\dots$***\n\n## 시각화 \n"},"formats":{"html":{"identifier":{"display-name":"HTML","target-format":"html","base-format":"html"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":false,"code-overflow":"scroll","code-link":false,"code-line-numbers":true,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","css":["../../styles.css"],"toc":true,"reference-location":"margin","output-file":"2023-06-08-15wk-1.html"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.4.322","theme":"cosmo","code-copy":true,"title-block-banner":false,"cap-location":"margin","citation-location":"margin","bibliography":["../ref.bib","ref.bib"],"title":"15wk-1: MCMC (3)","author":"최규빈","date":"06/01/2023","title-block-style":"none"},"extensions":{"book":{"multiFile":true}}},"ipynb":{"identifier":{"display-name":"Jupyter","target-format":"ipynb","base-format":"ipynb"},"execute":{"fig-width":7,"fig-height":5,"fig-format":"png","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":true,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":false,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"jupyter"},"render":{"keep-tex":false,"keep-typ":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"ipynb","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"inline-includes":false,"preserve-yaml":false,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[],"notebook-links":true},"pandoc":{"standalone":true,"default-image-extension":"png","to":"ipynb","reference-location":"margin","output-file":"2023-06-08-15wk-1.ipynb"},"language":{"toc-title-document":"Table of contents","toc-title-website":"On this page","related-formats-title":"Other Formats","related-notebooks-title":"Notebooks","source-notebooks-prefix":"Source","other-links-title":"Other Links","code-links-title":"Code Links","launch-dev-container-title":"Launch Dev Container","launch-binder-title":"Launch Binder","article-notebook-label":"Article Notebook","notebook-preview-download":"Download Notebook","notebook-preview-download-src":"Download Source","notebook-preview-back":"Back to Article","manuscript-meca-bundle":"MECA Bundle","section-title-abstract":"Abstract","section-title-appendices":"Appendices","section-title-footnotes":"Footnotes","section-title-references":"References","section-title-reuse":"Reuse","section-title-copyright":"Copyright","section-title-citation":"Citation","appendix-attribution-cite-as":"For attribution, please cite this work as:","appendix-attribution-bibtex":"BibTeX citation:","title-block-author-single":"Author","title-block-author-plural":"Authors","title-block-affiliation-single":"Affiliation","title-block-affiliation-plural":"Affiliations","title-block-published":"Published","title-block-modified":"Modified","title-block-keywords":"Keywords","callout-tip-title":"Tip","callout-note-title":"Note","callout-warning-title":"Warning","callout-important-title":"Important","callout-caution-title":"Caution","code-summary":"Code","code-tools-menu-caption":"Code","code-tools-show-all-code":"Show All Code","code-tools-hide-all-code":"Hide All Code","code-tools-view-source":"View Source","code-tools-source-code":"Source Code","code-line":"Line","code-lines":"Lines","copy-button-tooltip":"Copy to Clipboard","copy-button-tooltip-success":"Copied!","repo-action-links-edit":"Edit this page","repo-action-links-source":"View source","repo-action-links-issue":"Report an issue","back-to-top":"Back to top","search-no-results-text":"No results","search-matching-documents-text":"matching documents","search-copy-link-title":"Copy link to search","search-hide-matches-text":"Hide additional matches","search-more-match-text":"more match in this document","search-more-matches-text":"more matches in this document","search-clear-button-title":"Clear","search-detached-cancel-button-title":"Cancel","search-submit-button-title":"Submit","search-label":"Search","toggle-section":"Toggle section","toggle-sidebar":"Toggle sidebar navigation","toggle-dark-mode":"Toggle dark mode","toggle-reader-mode":"Toggle reader mode","toggle-navigation":"Toggle navigation","crossref-fig-title":"Figure","crossref-tbl-title":"Table","crossref-lst-title":"Listing","crossref-thm-title":"Theorem","crossref-lem-title":"Lemma","crossref-cor-title":"Corollary","crossref-prp-title":"Proposition","crossref-cnj-title":"Conjecture","crossref-def-title":"Definition","crossref-exm-title":"Example","crossref-exr-title":"Exercise","crossref-ch-prefix":"Chapter","crossref-apx-prefix":"Appendix","crossref-sec-prefix":"Section","crossref-eq-prefix":"Equation","crossref-lof-title":"List of Figures","crossref-lot-title":"List of Tables","crossref-lol-title":"List of Listings","environment-proof-title":"Proof","environment-remark-title":"Remark","environment-solution-title":"Solution","listing-page-order-by":"Order By","listing-page-order-by-default":"Default","listing-page-order-by-date-asc":"Oldest","listing-page-order-by-date-desc":"Newest","listing-page-order-by-number-desc":"High to Low","listing-page-order-by-number-asc":"Low to High","listing-page-field-date":"Date","listing-page-field-title":"Title","listing-page-field-description":"Description","listing-page-field-author":"Author","listing-page-field-filename":"File Name","listing-page-field-filemodified":"Modified","listing-page-field-subtitle":"Subtitle","listing-page-field-readingtime":"Reading Time","listing-page-field-wordcount":"Word Count","listing-page-field-categories":"Categories","listing-page-minutes-compact":"{0} min","listing-page-category-all":"All","listing-page-no-matches":"No matching items","listing-page-words":"{0} words"},"metadata":{"title-block-banner":false,"cap-location":"margin","citation-location":"margin","bibliography":["../ref.bib","ref.bib"],"title":"15wk-1: MCMC (3)","author":"최규빈","date":"06/01/2023","title-block-style":"none"}}},"projectFormats":["html"]}